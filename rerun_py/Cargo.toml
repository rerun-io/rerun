[package]
name = "re_sdk_python"        # name of the rust crate
edition.workspace = true
license.workspace = true
publish = false
rust-version.workspace = true
version.workspace = true

[lib]
crate-type = ["cdylib"]
name = "rerun_bindings" # name of the .so library that the Python module will import


[features]
default = ["extension-module", "re_viewer"]

## Enable embedding the Rerun Viewer in the Python SDK.
re_viewer = ["rerun_sdk/re_viewer"]

# We need to enable the `pyo3/extension-module` when building the SDK,
# but we cannot enable it when building tests and benchmarks, so we
# must make it an opt-in feature.
# https://pyo3.rs/latest/faq.html#i-cant-run-cargo-test-or-i-cant-build-in-a-cargo-workspace-im-having-linker-issues-like-symbol-not-found-or-undefined-reference-to-_pyexc_systemerror
# https://pyo3.rs/latest/building_and_distribution.html#building-python-extension-modules
extension-module = ["pyo3/extension-module"]

## Support serving a web viewer over HTTP.
##
## Enabling this adds quite a bit to the compile time and binary size,
## since it requires compiling and bundling the viewer as wasm.
web = ["rerun/web", "rerun_sdk/web"]

[dependencies]
re_error = { path = "../crates/re_error" }
re_log = { path = "../crates/re_log" }
re_log_types = { path = "../crates/re_log_types" }
re_memory = { path = "../crates/re_memory" }
re_sdk_comms = { path = "../crates/re_sdk_comms", features = ["client"] }
re_tensor_ops = { path = "../crates/re_tensor_ops" }
rerun = { path = "../crates/rerun" }
rerun_sdk = { path = "../crates/rerun_sdk" }

ahash = "0.8"
arrow2 = { workspace = true, features = ["io_ipc", "io_print"] }
bytemuck = { version = "1.11", features = ["extern_crate_alloc"] }
crossbeam = "0.8"
document-features = "0.2"
glam = "0.20"
half = "1.8"
image = { version = "0.24", default-features = false, features = [
  "jpeg",
  "jpeg_rayon",
] }
itertools = "0.10"
macaw = "0.17"
mimalloc = { version = "0.1.29", features = ["local_dynamic_tls"] }
numpy = { version = "0.17", features = ["half"] }
pyo3 = "0.17"
rand = { version = "0.8", features = ["std_rng"] }
tokio = { version = "1.16", features = ["rt-multi-thread"] }
tracing-subscriber = "0.3"
uuid = "1.1"

[build-dependencies]
pyo3-build-config = "0.17"

[package.metadata.maturin]
name = "rerun.rerun_bindings"
